{% extends "crud/create_view.html" %}
{% load static %}
{% block card_header %}
    <h3 class="text-dark">Ficha de Funcionário</h3>
    <span>Admissão em {{ form.admission_date.value }}</span>
{% endblock %}
{% block scripts %}
    <script>
        $(document).ready(() => {
            function loadImage(target) {
                let file = $(target).get(0).files[0];
                let imgPreview = $("#img_preview");
                if (file) {
                    let reader = new FileReader();
                    reader.onload = function () {
                        imgPreview.attr("src", reader.result);
                    }
                    reader.readAsDataURL(file);
                }
            }

            $(`<img id="img_preview" alt="preview" style="width:300px; height:300px;"><br><button type="button" class="btn btn-danger my-2" id="removeImage"><i class="fa fa-trash"></i></button>`).insertAfter("#id_photo")
            $("#id_photo").change(function(){
                loadImage(this);
            });

            $("#removeImage").click(function(){
                if (confirm("Deseja remover a foto?")){
                    $("#id_photo").val(null);
                    $("#img_preview").attr("src", null);
                }
            })
            {% if object.photo %}
                $("#img_preview").attr("src", "{{ object.photo.url }}")
            {% endif %}
        });
    </script>
{% endblock scripts %}